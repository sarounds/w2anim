Notes for installation of Strawberry Perl, ActiveTcl, and The W2 Animator
Stewart Rounds, 19-Jul-2022; updated 6-Nov-2025.


-------
General
-------

The W2 Animator is written in Perl and uses the Tcl/Tk toolkit for its
user interface.  To run the program, both Perl and Tcl must be installed,
along with several required modules of those interpreters.  Tcl is needed
because the Tk module in Perl is not up to date, whereas the Tcl/Tk module
is up to date.  The W2 Animator requires version 8.6 of Tk to build and use
all of the features of its user interface, and the Tcl/Tk module utilizes
version 8.6 or later of Tk.

These instructions describe how to install the Strawberry Perl and ActiveTcl
distributions of Perl and Tcl, respectively, on a 64-bit Windows system.
If you wish to install different distributions of these languages, feel free,
but the instructions here are specific to Strawberry Perl and ActiveTcl.
The W2 Animator should work on multiple operating systems, but you may
need different source distributions of Perl and Tcl to make it work on
each operating system.


-----------------------
Install Strawberry Perl
-----------------------

Strawberry Perl is a free distribution of Perl for Windows that is designed
to be as close as possible to the Perl environments on unix systems.
Strawberry Perl is free and available at https://strawberryperl.com/.
Download the installer for your system and install it as you would normally
install any Windows program.  I am using version 5.42.0.1 (64-bit) of
Strawberry Perl, which is the current version as of this writing, to my
system at C:\Perl\Strawberry\.  Previously, I had used version 5.32.1.1
(64-bit) of Strawberry Perl with great success.


-----------------
Install ActiveTcl
-----------------

ActiveState provides packages for several useful languages.
I signed up for a free account at ActiveState, which you can find at
https://www.activestate.com/products/tcl/.  I downloaded the most-recent
standard and recommended Tcl package for Windows, which is version
8.6.14.0000 (64-bit), built on 8-Oct-2024. You can find that package at
https://platform.activestate.com/ActiveState/TclTk-RecommendedVersion/distributions.
Previously, I had successfully used version 8.6.12.0000 (64-bit), but that
version is no longer available from ActiveState.  Install the Tcl package as
you would any Windows program.  I installed my package to C:\Tcl\ActiveTcl\.

It is likely that you will need to make a few edits to one file in the Tcl
package after installation.  In the file:
  C:\Tcl\ActiveTcl\lib\tclConfig.sh
I found six lines that the installer did not properly complete.  Here are the
6 lines, where I commented out the first line in the pair, copied it to the
second line and edited the second line to have the correct path and syntax:

#TCL_PREFIX='C:\TEMP\ActiveState----------------------------------------please-run-the-install-script----------------------------------------'
TCL_PREFIX='C:\Tcl\ActiveTcl'

#TCL_EXEC_PREFIX='C:\TEMP\ActiveState----------------------------------------please-run-the-install-script----------------------------------------\bin'
TCL_EXEC_PREFIX='C:\Tcl\ActiveTcl\bin'

#TCL_LIB_SPEC='C:\TEMP\ActiveState----------------------------------------please-run-the-install-script----------------------------------------\lib\tcl86t.lib'
TCL_LIB_SPEC='-LC:\Tcl\ActiveTcl\lib\tcl86t.lib'

#TCL_INCLUDE_SPEC='-IC:\TEMP\ActiveState----------------------------------------please-run-the-install-script----------------------------------------\include'
TCL_INCLUDE_SPEC='-IC:\Tcl\ActiveTcl\include'

#TCL_STUB_LIB_SPEC='-LC:\TEMP\ActiveState----------------------------------------please-run-the-install-script----------------------------------------\lib tclstub86.lib'
TCL_STUB_LIB_SPEC='-LC:\Tcl\ActiveTcl\lib tclstub86.lib'

#TCL_STUB_LIB_PATH='C:\TEMP\ActiveState----------------------------------------please-run-the-install-script----------------------------------------\lib\tclstub86.lib'
TCL_STUB_LIB_PATH='C:\Tcl\ActiveTcl\lib\tclstub86.lib'

With these modifications to the tclConfig.sh file, Strawberry Perl will
be able to download and properly compile the Perl Tkx module, which is a
simple interface to the Tcl/Tk package.  Without these modifications, the
Tkx interface in Perl to Tcl/Tk will not be available and The W2 Animator
program will not run properly.


---------------------------------
Modify the System PATH (optional)
---------------------------------

I found it useful to modify the Windows system PATH.  The installer
for ActiveTcl unnecessarily puts its folder at the top of the PATH list,
whereas Strawberry Perl puts its entries at the bottom of the system PATH.
To modify your Windows system PATH, click the Start menu and select Settings.
Then type "system path" into the search bar.  On Windows, you need to be
Administrator to modify the system PATH.  You may or may not need to get
your system administrator to assist you with some of these installations.

I moved the three entries for Strawberry Perl up to the top, before the
Tcl path, as follows:
  C:\Perl\Strawberry\c\bin
  C:\Perl\Strawberry\perl\site\bin
  C:\Perl\Strawberry\perl\bin
  C:\Tcl\ActiveTcl\bin


-----------------------------
Install Required Perl Modules
-----------------------------

The W2 Animator requires several additional Perl modules to be installed.
This is a common task and is fairly simple to carry out.

Start by opening Strawberry Perl's text interface.  Check the Start menu
for a new item-- it is probably labelled "Perl (command line)."  I added
a shortcut to my taskbar for future use.

New modules can be installed in Strawberry Perl, and indeed in most Perl
distributions, by using the "cpanm" command.  It's really simple, but pay
attention to the messages it prints to the screen.  If you have problems, you
should be able to find a "build.log" file in C:\Users\your_user_name\.cpanm\
that will be more verbose.  You will also find more build logs under
C:\Users\your_user_name\.cpanm\work\.

Running as Administrator (I don't know if this is necessary), I started
by installing the Perl Tkx module with:
  cpanm Tkx

The Tkx module is small and quick to install, but it requires the Tcl module
as a dependency, and so will install the Tcl module as well.  The Tck/Tk
module is used for creating user interfaces.  As a result, you will
see many different windows popping up as various tests are generated and run.
Do not be alarmed, as this is normal.

Other Perl modules that you will need, and their installation commands:
  cpanm Tkx::ROText
  cpanm Tkx::Scrolled
  cpanm Proc::Background
  cpanm File::Find::Object
  cpanm Win32::GUI
If you have any problems installing any of these modules, which may happen
if some automated tests fail, you may need to force the installation, such
as:
  cpanm Win32::GUI --force

As an aside, The W2 Animator does not need Perl's Tk module to be installed,
but if you are using Perl for some other programs, you may want the Tk module.
A known bug in the Perl Tk module makes its installation difficult with the
latest packages.  To install the Perl Tk module, you need to point cpanm to
a different repository that has a "patched" package with some fixes:
  cpanm https://github.com/StrawberryPerl/Perl-Dist-Strawberry/releases/download/patched_cpan_modules/Tk-804.036_001.tar.gz --force
But, this is optional and not needed for W2Anim.

All of the other modules required by The W2 Animator should already be
part of the standard distribution of Strawberry Perl.  For example, the
Math::Trig and Imager modules are already installed.

When I was using Strawberry Perl version 5.32.1.1, I found one error in
its Tcl module, which has since been fixed.  If you are using an older
version of Perl, you may need to edit the file at:
  C:\Perl\Strawberry\perl\site\lib\Tcl.pm

In that file, find the line that looks like:
      print "TCL::TRACE_DELETECOMMAND: $interp -> ( $tclname )\n" if TRACE_DELETECOMMAND();

This line may be missing a "Tcl::" in front of the final TRACE_DELETECOMMAND.
So, the fixed line should look like:
      print "TCL::TRACE_DELETECOMMAND: $interp -> ( $tclname )\n" if Tcl::TRACE_DELETECOMMAND();

Doing this little edit may be tricky, as the default file permissions for the
Tcl.pm file don't include write permissions, even for the owner.  I worked
around it by changing the file's user write permission while logged in as
Administrator in my Cygwin environment and editing the file with vi there.
Another user reported that you can open the file in Notepad++, right-click
on the file-name tab, and choose the option to clear the ReadOnly flag.
You may find another solution.

That's all.  You should now have a functioning Strawberry Perl environment
with ActiveTcl available to assist.


-----------------------
Install The W2 Animator
-----------------------

The W2 Animator does not have its own installation program. You simply need
to get the latest code package from GitHub at:
  https://github.com/sarounds/w2anim/releases/latest
and unzip that package into your chosen directory where The W2 Animator will
reside on your computer, such as C:\Data\w2anim on a Windows system. It is
your choice; just make sure you have read and write access to that location.
When updating or installing for the first time, be sure to update the path
in the w2anim.bat file to point to the location on your computer where the
W2Anim scripts reside.

Once the scripts and associated files have been unzipped, you can start up
The W2 Animator in several different ways, such as invoking the w2anim.pl
file from a command window or by double-clicking that file from the Windows
File Explorer after it has been associated with the Perl program. See the
User Manual for more information.

If you are running W2Anim under Windows, you may find that Windows has
tagged the W2Anim package files as from an unknown publisher. As a result,
Windows may attach an "Alternate Data Stream" to the various files that
were downloaded, and every file in the unzipped package now may have a
Zone.Identifier as part of their Alternate Data Stream. This is not a huge
problem, but it will cause a warning message from Windows to appear each
time you run W2Anim, and that can become annoying.

The solution is to identify which files (probably all) have that Alternate
Data Stream, and then remove that Alternate Data Stream from those files.

In a regular Command window:
  - Navigate to the proper folder.
  - Issue this command:
      dir /r /s |findstr /e ":$DATA"
That command will recursively find any files that have an Alternate Data
Stream and list them.

Then in a PowerShell window:
  - Navigate to the proper folder.
  - Issue these commands:
      Unblock-File *
      Unblock-File */*
      Unblock-File */*/*

Finally, go back to the regular Command window and re-issue the dir|findstr
command as above to ensure that all of the Alternate Data Streams have been
removed.
